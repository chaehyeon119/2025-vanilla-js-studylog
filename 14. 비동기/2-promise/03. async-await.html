<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // ğŸ¯ ì´ ì˜ˆì œì˜ ëª©ì : async/awaitë¥¼ ì‚¬ìš©í•œ ë¹„ë™ê¸° ì‘ì—… ì²˜ë¦¬í•˜ê¸°
      // async/awaitëŠ” Promise ì²´ì´ë‹ë³´ë‹¤ ë” ì½ê¸° ì‰½ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ ë¹„ë™ê¸° ì²˜ë¦¬ ë°©ë²•ì…ë‹ˆë‹¤
      // ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ì—ì„œëŠ” ë³µì¡í•œ ë¹„ë™ê¸° ì‘ì—…ì„ ë™ê¸° ì½”ë“œì²˜ëŸ¼ ì‘ì„±í•  ë•Œ ìì£¼ ì‚¬ìš©ë©ë‹ˆë‹¤

      // 1. ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸ì„ í•˜ê³  ë‹µë³€ì„ ë°›ëŠ” í•¨ìˆ˜
      // ì´ í•¨ìˆ˜ëŠ” Promiseë¥¼ ë°˜í™˜í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤
      function question() {
        // 2. ìƒˆë¡œìš´ Promise ê°ì²´ ìƒì„±
        // PromiseëŠ” "ë‚˜ì¤‘ì— ê²°ê³¼ë¥¼ ì¤„ê²Œ"ë¼ëŠ” ì•½ì†ì…ë‹ˆë‹¤
        return new Promise((resolve, reject) => {
          // 3. 1ì´ˆ í›„ì— ì‹¤í–‰ë˜ëŠ” íƒ€ì´ë¨¸ ì„¤ì •
          // setTimeoutì€ "1ì´ˆ í›„ì— ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•´"ë¼ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤
          setTimeout(() => {
            // 4. ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸í•˜ê¸°
            // promptëŠ” ì‚¬ìš©ìì—ê²Œ ì…ë ¥ì°½ì„ ë„ìš°ëŠ” ë„êµ¬ì…ë‹ˆë‹¤
            const result = prompt("ì „ì£¼ ìµœê³ ì˜ ë§›ì§‘ì€?");

            // 5. ì‚¬ìš©ì ë‹µë³€ í™•ì¸í•˜ê¸°
            if (result === "í—ˆê°€ë‚¸ë‹­ë°œ") {
              // 6. ì •ë‹µì¸ ê²½ìš° ì„±ê³µ ì²˜ë¦¬
              // resolveëŠ” "ì„±ê³µí–ˆì–´!"ë¼ê³  ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
              resolve("ë§ì•˜ì–´ìš”!");
            } else {
              // 7. í‹€ë¦° ê²½ìš° ì‹¤íŒ¨ ì²˜ë¦¬
              // rejectëŠ” "ì‹¤íŒ¨í–ˆì–´!"ë¼ê³  ì•Œë ¤ì£¼ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
              reject("ë•¡!!!");
            }
          }, 1000); // 1000ms = 1ì´ˆ
        });
      }

      // 8. ì²« ë²ˆì§¸ ë‹¨ê³„ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
      // ì´ í•¨ìˆ˜ë„ Promiseë¥¼ ë°˜í™˜í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤
      function step1(value) {
        // 9. ìƒˆë¡œìš´ Promise ê°ì²´ ìƒì„±
        return new Promise((resolve) => {
          // 10. 1ì´ˆ í›„ì— ì‹¤í–‰ë˜ëŠ” íƒ€ì´ë¨¸ ì„¤ì •
          setTimeout(() => {
            // 11. ì „ë‹¬ë°›ì€ ê°’ì„ ì½˜ì†”ì— ì¶œë ¥í•˜ê¸°
            console.log("step1 ì…ë ¥ê°’: ", value);
            // 12. ì‘ì—… ì™„ë£Œ í›„ ê²°ê³¼ ë°˜í™˜
            // resolveëŠ” Promiseë¥¼ ì„±ê³µìœ¼ë¡œ ì™„ë£Œì‹œí‚¤ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
            resolve("step1ì˜ resolveì— ë„£ì€ ê°’");
          }, 1000); // 1ì´ˆ ëŒ€ê¸°
        });
      }

      // 13. ë‘ ë²ˆì§¸ ë‹¨ê³„ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜
      function step2(value) {
        // 14. ìƒˆë¡œìš´ Promise ê°ì²´ ìƒì„±
        return new Promise((resolve) => {
          // 15. 1ì´ˆ í›„ì— ì‹¤í–‰ë˜ëŠ” íƒ€ì´ë¨¸ ì„¤ì •
          setTimeout(() => {
            // 16. ì „ë‹¬ë°›ì€ ê°’ì„ ì½˜ì†”ì— ì¶œë ¥í•˜ê¸°
            console.log("step2 ì…ë ¥ê°’: ", value);
            // 17. ì‘ì—… ì™„ë£Œ í›„ ê²°ê³¼ ë°˜í™˜
            resolve("step2ì˜ resolveì— ë„£ì€ ê°’");
          }, 1000); // 1ì´ˆ ëŒ€ê¸°
        });
      }

      // 18. ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜ (IIFE) - async/await ì‚¬ìš©
      // asyncëŠ” "ì´ í•¨ìˆ˜ëŠ” ë¹„ë™ê¸° ì‘ì—…ì„ í•  ê±°ì•¼"ë¼ê³  ì•Œë ¤ì£¼ëŠ” í‚¤ì›Œë“œì…ë‹ˆë‹¤
      (async function () {
        // 19. try-catchë¡œ ì—ëŸ¬ë¥¼ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬í•˜ê¸°
        try {
          // 20. question í•¨ìˆ˜ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ëŒ€ê¸°í•˜ê¸°
          // awaitëŠ” "ì´ê²ƒì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤"ë¼ëŠ” í‚¤ì›Œë“œì…ë‹ˆë‹¤
          // awaitëŠ” async í•¨ìˆ˜ ì•ˆì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
          const result0 = await question();
          // 21. question í•¨ìˆ˜ì˜ ê²°ê³¼ ì¶œë ¥í•˜ê¸°
          console.log("question ì„±ê³µ, ì •ë‹µ ë§ì¶¤!", result0);

          // 22. step1 í•¨ìˆ˜ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ëŒ€ê¸°í•˜ê¸°
          // result0ë¥¼ step1 í•¨ìˆ˜ì— ì „ë‹¬í•©ë‹ˆë‹¤
          const result1 = await step1(result0);
          // 23. step1 í•¨ìˆ˜ì˜ ê²°ê³¼ ì¶œë ¥í•˜ê¸°
          console.log("step1 ì„±ê³µ", result1);

          // 24. step2 í•¨ìˆ˜ ì‹¤í–‰í•˜ê³  ê²°ê³¼ ëŒ€ê¸°í•˜ê¸°
          // result1ì„ step2 í•¨ìˆ˜ì— ì „ë‹¬í•©ë‹ˆë‹¤
          const result2 = await step2(result1);
          // 25. step2 í•¨ìˆ˜ì˜ ê²°ê³¼ ì¶œë ¥í•˜ê¸°
          console.log("step2 ì„±ê³µ", result2);
        } catch (err) {
          // 26. ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
          // ì–´ëŠ ë‹¨ê³„ì—ì„œë“  ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì´ ë¶€ë¶„ì´ ì‹¤í–‰ë©ë‹ˆë‹¤
          console.error(err);
        } finally {
          // 27. ì„±ê³µí•˜ë“  ì‹¤íŒ¨í•˜ë“  ë§ˆì§€ë§‰ì— í•­ìƒ ì‹¤í–‰ë˜ëŠ” ì½”ë“œ
          // 1ì´ˆ í›„ì— "FINALLYYYYYY"ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤
          setTimeout(() => {
            console.log("FINALLYYYYYY");
          }, 1000);
        }
      })(); // â† ì—¬ê¸°ì„œ í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ ì‹¤í–‰!

      // ğŸ“š async/await vs Promise ì²´ì´ë‹ ë¹„êµ:
      //
      // Promise ì²´ì´ë‹ ë°©ì‹:
      // question()
      //   .then(result => step1(result))
      //   .then(result => step2(result))
      //   .then(result => console.log(result))
      //   .catch(err => console.error(err));
      //
      // async/await ë°©ì‹ (í˜„ì¬ ì½”ë“œ):
      // const result0 = await question();
      // const result1 = await step1(result0);
      // const result2 = await step2(result1);
      // console.log(result2);

      // ğŸ” async/awaitì˜ ì¥ì :
      // 1. ì½ê¸° ì‰¬ì›€: ë™ê¸° ì½”ë“œì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤
      // 2. ì—ëŸ¬ ì²˜ë¦¬: try-catchë¡œ ê°„ë‹¨í•˜ê²Œ ì²˜ë¦¬
      // 3. ë³€ìˆ˜ í• ë‹¹: ê° ë‹¨ê³„ì˜ ê²°ê³¼ë¥¼ ë³€ìˆ˜ì— ì €ì¥ ê°€ëŠ¥
      // 4. ë””ë²„ê¹…: ì¤‘ê°„ì— breakpointë¥¼ ì‰½ê²Œ ì„¤ì • ê°€ëŠ¥

      // ğŸ’¡ Promiseì˜ ìƒíƒœ:
      // ì„±ê³µ: fulfilled (ì™„ë£Œë¨)
      // ì‹¤íŒ¨: rejected (ê±°ë¶€ë¨)
      // ì²˜ë¦¬ì¤‘: pending (ëŒ€ê¸°ì¤‘)
    </script>
  </body>
</html>
