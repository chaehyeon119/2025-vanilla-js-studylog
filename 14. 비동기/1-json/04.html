<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // 🎯 이 예제의 목적: async/await와 즉시 실행 함수(IIFE)를 함께 사용하는 방법 배우기
      // 이전 예제들과 달리 여기서는 함수를 만들자마자 바로 실행하는 특별한 구조를 사용합니다
      // 실제 웹사이트에서는 페이지가 로드되자마자 데이터를 가져와야 할 때 자주 사용됩니다

      // 📚 즉시 실행 함수(IIFE) 구조 설명:
      // (async () => { ... })();
      // ↑     ↑        ↑   ↑
      // │     │        │   └── 즉시 실행! (함수를 바로 호출)
      // │     │        └────── 함수의 내용 (중괄호 안의 코드)
      // │     └─────────────── 화살표 함수 (익명 함수)
      // └───────────────────── 괄호로 감싸기 (함수를 표현식으로 만들기)

      // 즉시 호출 함수(익명) - IIFE (Immediately Invoked Function Expression)
      (async () => {
        // 1. try-catch로 에러를 안전하게 처리하기
        try {
          // 2. 서버에서 JSON 파일 가져오기 (fetch)
          // fetch는 서버에 "데이터 좀 주세요!"라고 요청하는 도구입니다
          // "data.json"은 서버에 있는 JSON 파일의 이름입니다
          const res = fetch("data.json");

          // 3. 서버 응답 상태 확인하기
          // res.ok는 서버 응답이 성공(200)인지 확인하는 속성입니다
          // 만약 파일이 없거나 서버에 문제가 있으면 false가 됩니다
          if (!res.ok) {
            // 4. 에러가 발생했을 때 강제로 에러를 발생시키기
            // throw는 "여기서 에러가 발생했다!"라고 알려주는 명령어입니다
            // new Error()는 에러 메시지를 담은 에러 객체를 만듭니다
            throw new Error("에러 발생!");
          }

          // 5. 서버 응답을 JSON 형태로 변환하기
          // await는 "이것이 완료될 때까지 기다려"라는 뜻입니다
          // res.json()은 응답을 JavaScript 객체로 바꿔주는 도구입니다
          const data = await res.json();

          // 6. 변환된 데이터 출력하기
          console.log(data);
        } catch (err) {
          // 7. 에러가 발생했을 때 실행될 코드
          // err는 어떤 에러가 발생했는지 알려주는 정보입니다
          console.error(err);
        }
      })(); // ← 여기서 함수를 즉시 실행!

      // 📚 추가 설명:
      // - async: "이 함수는 비동기 작업을 할 거야"라고 알려주는 키워드
      // - await: "이것이 완료될 때까지 기다려"라는 키워드 (async 함수 안에서만 사용 가능)
      // - IIFE: 함수를 만들자마자 바로 실행하는 패턴
      // - 이 구조의 장점: 전역 변수 오염을 방지하고, 코드를 즉시 실행할 수 있습니다
      // - 실제 웹사이트에서는 페이지 로드 시 자동으로 데이터를 가져올 때 자주 사용됩니다
    </script>
  </body>
</html>
